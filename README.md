# news_feed

Генератор унифицированной ленты новостей (JSON Feed 1.1) по отраслевым источникам.

## Как это работает

GitHub Actions раз в 30 минут запускает сборщик, который обращается к списку источников в `sources.yaml`,
забирает последние материалы и публикует итоговый JSON в `docs/unified.json`. GitHub Pages раздаёт его по адресу:

```
https://<ваш-логин>.github.io/news_feed/unified.json
```

## Быстрый старт

1. Создайте пустой репозиторий `news_feed` и включите **GitHub Pages** с корнем `/docs`.
2. Загрузите ВСЁ содержимое этого архива в корень репозитория.
3. Убедитесь, что включены GitHub Actions и у Actions есть права на запись.
4. Вкладка **Actions → Build feed → Run workflow** (можно запустить вручную). Либо подождите автоматический запуск (каждые 30 минут).

## Локальный запуск

```bash
python -m venv .venv && . .venv/bin/activate
pip install -r requirements.txt
python -m src.build
```

Лента будет в `docs/unified.json`.

## Что нового по сравнению с прошлой версией

- Фильтрация Metalinfo: берём только статьи `/ru/news/<id>`, отбрасываем категории/теги/комментарии.
- Троттлинг и экспоненциальный бэкофф; у `metalinfo.ru` — 5 секунд между запросами по домену.
- Парсинг дат через `dateparser` (ru, TZ=Europe/Moscow), без «заглушек» сегодняшней датой.
- На сайтах с RSS — используем feedparser (устойчивее и меньше банов).
- Если сайт отдаёт 401/403/таймаут — помечаем как `manual` в `sources.yaml` (лента строится без падений).
- Больше не пишем 0 items при 304/ошибке: просто пропускаем источник и идём дальше.
